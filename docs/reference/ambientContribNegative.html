<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ambient contribution from negative controls — ambientContribNegative • DropletUtils</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Ambient contribution from negative controls — ambientContribNegative" />
<meta property="og:description" content="Estimate the contribution of the ambient solution to a particular expression profile,
based on the abundance of negative control features that should not be expressed in the latter." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DropletUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/DropletUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Ambient contribution from negative controls</h1>
    
    <div class="hidden name"><code>ambientContribNegative.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the contribution of the ambient solution to a particular expression profile,
based on the abundance of negative control features that should not be expressed in the latter.</p>
    </div>

    <pre class="usage"><span class='fu'>controlAmbience</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>

<span class='fu'>ambientContribNegative</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for ANY</span>
<span class='fu'>ambientContribNegative</span><span class='op'>(</span>
  <span class='va'>y</span>,
  <span class='va'>ambient</span>,
  <span class='va'>features</span>,
  mode <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"scale"</span>, <span class='st'>"profile"</span>, <span class='st'>"proportion"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>ambientContribNegative</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>...</span>, assay.type <span class='op'>=</span> <span class='st'>"counts"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>For the generic, further arguments to pass to individual methods.</p>
<p>For the SummarizedExperiment method, further arguments to pass to the ANY method.</p>
<p>For <code>controlAmbience</code>, arguments to pass to <code>ambientContribNegative</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A numeric matrix-like object containing counts, where each row represents a feature (e.g., a gene or a conjugated tag)
and each column represents either a cell or group of cells.</p>
<p>Alternatively, a SummarizedExperiment object containing such a matrix.</p>
<p><code>y</code> can also be a numeric vector of counts; this is coerced into a one-column matrix.</p></td>
    </tr>
    <tr>
      <th>ambient</th>
      <td><p>A numeric vector of length equal to <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(y)</a></code>,
containing the proportions of transcripts for each gene in the ambient solution.
Alternatively, a matrix where each row corresponds to a row of <code>y</code>
and each column contains a specific ambient profile for the corresponding column of <code>y</code>.</p></td>
    </tr>
    <tr>
      <th>features</th>
      <td><p>A logical, integer or character vector specifying the negative control features in <code>y</code> and <code>ambient</code>.</p>
<p>Alternatively, a list of vectors specifying mutually exclusive sets of features.</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>String indicating the output to return, see Value.</p></td>
    </tr>
    <tr>
      <th>assay.type</th>
      <td><p>Integer or string specifying the assay containing the count matrix.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>mode="scale"</code>,
a numeric vector is returned quantifying the estimated &#8220;contribution&#8221; of the ambient solution to each column of <code>y</code>.
Scaling <code>ambient</code> by each entry yields the maximum ambient profile for the corresponding column of <code>y</code>.</p>
<p>If <code>mode="profile"</code>, a numeric matrix is returned containing the estimated ambient profile for each column of <code>y</code>.
This is computed by scaling as described above; if <code>ambient</code> is a matrix, each column is scaled by the corresponding entry of the scaling vector.</p>
<p>If <code>mode="proportion"</code>, a numeric matrix is returned containing the estimated proportion of counts in <code>y</code> that are attributable to ambient contamination.
This is computed by simply dividing the output of <code>mode="profile"</code> by <code>y</code> and capping all values at 1.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Negative control features should be those that cannot be expressed and thus fully attributable to ambient contamination.
This is most commonly determined <em>a priori</em> from the biological context and experimental system.
For example, if spike-ins were introduced into the solution prior to cell capture,
these would serve as a gold standard for ambient contamination in <code>y</code>.
For single-nuclei sequencing, mitochondrial transcripts can serve a similar role 
under the assumption that all high-quality libraries are stripped nuclei.</p>
<p>If <code>features</code> is a list, it is expected to contain multiple sets of mutually exclusive features.
Each cell should only express features in at most one set; no cell should express features in different sets.
The expression of multiple sets can thus be attributed to ambient contamination.
For this mode, an archetypal pairing is that of hemoglobins with immunoglobulins (Young and Behjati, 2018), 
which should not be co-expressed in any (known) cell type.</p>
<p><code>controlAmbience</code> is soft-deprecated; use <code>ambientContribNegative</code> instead.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Young MD and Behjati S (2018).
SoupX removes ambient RNA contamination from droplet based single-cell RNA sequencing data.
<em>biorXiv</em>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ambientProfileEmpty.html'>ambientProfileEmpty</a></code> or <code><a href='ambientProfileBimodal.html'>ambientProfileBimodal</a></code>, to obtain a profile estimate to use in <code>ambient</code>.</p>
<p><code><a href='ambientContribMaximum.html'>ambientContribMaximum</a></code> or <code><a href='ambientContribSparse.html'>ambientContribSparse</a></code>,
for other methods of estimating contribution when negative control features are not available.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Aaron Lun</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Making up some data.</span>
<span class='va'>ambient</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>900</span>, <span class='fl'>0</span>, <span class='fl'>0.1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span><span class='op'>(</span><span class='fl'>1000</span>, <span class='va'>ambient</span> <span class='op'>*</span> <span class='fl'>50</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span><span class='op'>(</span><span class='fl'>900</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># actual biology, but first 100 genes silent.</span>

<span class='co'># Using the first 100 genes as negative controls:</span>
<span class='va'>scaling</span> <span class='op'>&lt;-</span> <span class='fu'>ambientContribNegative</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>ambient</span>, features<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>scaling</span>
</div><div class='output co'>#&gt;        y 
#&gt; 50.99208 </div><div class='input'>
<span class='co'># Estimating the negative control contribution to 'y' by 'ambient'.</span>
<span class='va'>contribution</span> <span class='op'>&lt;-</span> <span class='fu'>ambientContribNegative</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>ambient</span>, features<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>, mode<span class='op'>=</span><span class='st'>"profile"</span><span class='op'>)</span>
<span class='fu'>DataFrame</span><span class='op'>(</span>ambient<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/drop.html'>drop</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span>, total<span class='op'>=</span><span class='va'>y</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 1000 rows and 2 columns
#&gt;        ambient     total
#&gt;      &lt;numeric&gt; &lt;integer&gt;
#&gt; 1     1.088222         0
#&gt; 2     4.126216         1
#&gt; 3     2.084820         2
#&gt; 4     0.842154         2
#&gt; 5     0.379576         0
#&gt; ...        ...       ...
#&gt; 996   21.75640        33
#&gt; 997   35.82016        46
#&gt; 998   38.19018        37
#&gt; 999    1.51501         7
#&gt; 1000  10.87488        15</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


